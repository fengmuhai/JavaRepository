项目总结
=====================

一、短信平台项目 - 易联
---------------------
**1.支付平台的请求短信发送两次的问题**

**问题描述**：更新项目后发现，每个订单都发送了两条短信。记录显示，dna平台先向旧通道梦网发了条短信，再向短信平台发一条。

**问题片排查**：通过查看短信平台的日志发现了问题，dna平台发到短信平台的请求要过20多秒才收到，日了狗...那dna平台肯定超时啊，所以dna又向旧通道发了一条。 
20多秒后，SMS接受到dna请求后又发送了短信，发两条短信的原因由此而来。

**bug分析**： 1.先不管平台为什么延时那么久才收到。首先，SMS平台的健壮性就有问题：为什么不判断对方发过来的请求的交易时间。超时那么久还要发？ 
2.生产上的机器间延时，如1.16、1.11到1.7延时20多秒

**解决办法**： 1.对于第一个问题，拿报文的transdatetime和接收时间比较，设置超时判断。超时时间比dna平台少1s； 
2.后来测试定位到问题出在了request.getRemoteHost()这一行，执行耗时将近20秒。网上查到相关资料是getRemoteHost()方法有性能的问题：https://blog.csdn.net/eleven204/article/details/6625701
